# 🎯 RD9 產品開發進度戰情室

以單一 HTML 檔案實作的產品開發進度儀表板，支援從 Google Sheets 自動同步或手動上傳 Excel 檔案，無需後端伺服器，開啟瀏覽器即可使用。

---

## 📋 功能概覽

### 資料來源（二擇一）
- **Google Sheets 自動同步**：透過 Google Apps Script 部署為 Web API，頁面載入時自動拉取最新資料，支援一鍵重新載入
- **Excel 本機上傳**：支援 `.xlsx` / `.xls` 格式，上傳後立即解析顯示，無需網路連線

### 頂部統計卡（4 項）
| 卡片 | 說明 |
|------|------|
| 總專案數 | 資料表中的所有項目筆數 |
| 進行中 | 尚未到達最終階段的項目數 |
| 已上市／結案 | 已完成最終階段的項目數 |
| 緊急項目 | 優先權標示為「緊急」的項目數 |

### 負責人更新狀態
- 列出所有「負責人1」欄位的人員，並顯示其最新一次更新日期
- 每人只顯示最近一筆（多筆取最新）
- **由最久未更新排到最近更新**，方便管理者追蹤誰需要補填資料
- 天數色彩提示：🟢 14 天內 ／ 🟡 15–30 天 ／ 🔴 31 天以上

### 搜尋與篩選列
| 篩選器 | 選項 |
|--------|------|
| 搜尋 | 產品名稱、產品編號、產品描述（即時搜尋） |
| 類別 | 依 Excel 資料動態產生 |
| 進度 | 進行中 / 已上市 |
| 優先權 | 緊急 / 重要 / 一般 / 次要 / 暫停 |
| 供貨狀態 | 研發 / 樣品 / 洽詢 / 發售 / 停產 / 暫停出貨 |
| 開發階段 | 規劃 / 研發 / 驗証 / 量產 / 上市（產品）<br>現勘 / 討論 / 報價 / 執行 / 結案（專案） |

### 產品卡片
每張卡片由上到下包含：

1. **卡片頭部**
   - 產品圖片（支援 HTTPS 圖片網址，無圖時顯示佔位圖）
   - 產品名稱（粗體大字）
   - 產品型號（Space Mono 字型，次標題）
   - 產品描述
   - 優先權標籤（依等級顯示不同顏色）
   - 供貨狀態圓點徽章
   - 預計上市時間
   - 負責人頭像（最多 3 人，圓形彩色頭像，顯示姓名後兩字）

2. **開發進度條**
   - 5 個節點的橫向進度軸
   - 已完成節點以藍色填充，未完成為灰色
   - 產品與專案各自使用不同的階段標籤

3. **專案歷程**（可捲動，最多顯示 280px 高度）
   - 逐行顯示歷史記錄，格式建議：`YYYY-MM: 說明`

---

## 📁 專案結構

```
.
├── index.html                    # 主程式（單一檔案，開啟即用）
└── 產品開發進度追蹤_RD9.xlsx      # 資料範本與現有資料
```

---

## 📊 Excel 資料格式

工作表名稱：**產品開發進度**（第一個工作表）

| 欄位名稱 | 必填 | 說明 | 範例 |
|----------|:----:|------|------|
| 產品名稱 | ✅ | 產品的完整名稱 | 通訊服務器 |
| 產品類別 | ✅ | 分類標籤，同類別會群組顯示 | 控制器 |
| 產品圖片網址 | | HTTPS 圖片連結 | https://example.com/img.png |
| 產品描述 | | 簡短說明文字 | IIoT 通訊服務器, 1 個 Ethernet 埠 |
| 優先權 | ✅ | 緊急 / 重要 / 一般 / 次要 / 暫停 | 一般 |
| 供貨狀態 | ✅ | 研發 / 樣品 / 洽詢 / 發售 / 停產 / 暫停出貨 | 發售 |
| 預計上市時間 | | 自由格式 | 2025.Q3 |
| 開發階段 | ✅ | 規劃 / 研發 / 驗証 / 量產 / 上市 | 上市 |
| 負責人1 | ✅ | 第一負責人姓名 | 王小明 |
| 負責人1顏色 | | 16 進位色碼 | #512d78 |
| 負責人2 | | 第二負責人姓名（選填） | 李大華 |
| 負責人2顏色 | | 16 進位色碼（選填） | #33A1FF |
| 負責人3 | | 第三負責人姓名（選填） | 張美玲 |
| 負責人3顏色 | | 16 進位色碼（選填） | #FFBD33 |
| 產品編號 | | 唯一識別碼 | UA-5231 |
| 專案歷程 | | 多行文字，每行一筆記錄 | 2025-01: 完成開發 |
| 最後更新日期 | | 格式：YYYY-MM-DD | 2025-06-01 |

> **專案類型**：若「產品名稱」欄填入「專案」，開發階段將自動切換為專案流程：現勘 → 討論 → 報價 → 執行 → 結案

---

## 🚀 使用方式

### 方法一：Google Sheets 連線（建議）

1. 建立 Google Sheets，欄位格式同上表
2. 開啟試算表 → **擴充功能 → Apps Script**
3. 部署為 Web 應用程式（存取權設為「任何人」）
4. 複製部署網址，貼入 `index.html` 第 775 行的 `APPS_SCRIPT_URL` 變數
5. 直接用瀏覽器開啟 `index.html`，資料將自動載入

### 方法二：Excel 本機上傳

1. 下載頁面上的 **📥 下載範本** 按鈕取得範本
2. 填入產品資料後存檔
3. 點選頁面上的 **📁 上傳 Excel 檔案** 按鈕，選取檔案即可

---

## 🔒 安全機制

| 機制 | 說明 |
|------|------|
| XSS 防護 | 所有輸出文字皆經 HTML Escape 處理 |
| URL 驗證 | 圖片網址限制為 HTTPS 協定 |
| API 限流 | 每分鐘最多發出 10 次 Google Sheets 請求 |
| CSP 標頭 | Content Security Policy 限制資源來源 |
| 點擊劫持防護 | X-Frame-Options: DENY |
| MIME 嗅探防護 | X-Content-Type-Options: nosniff |
| 請求逾時 | Google Sheets API 請求超過 30 秒自動中斷 |

---

## 🛠️ 技術規格

- **前端**：純 HTML / CSS / Vanilla JavaScript（無框架）
- **Excel 解析**：[SheetJS (xlsx) v0.18.5](https://sheetjs.com/)（CDN 載入）
- **字型**：Noto Sans TC、Space Mono（Google Fonts）
- **瀏覽器支援**：Chrome、Edge、Firefox、Safari（現代版本）
- **RWD**：支援行動裝置，768px 以下自動切換為單欄卡片

---

## 📝 注意事項

- 使用 Google Sheets 模式時，需確認 Apps Script 已正確部署且存取權限為公開
- Excel 上傳模式不需網路連線，所有資料處理皆在本機瀏覽器執行
- 產品圖片需使用 HTTPS 網址，HTTP 連結將被自動封鎖
- 專案歷程建議使用 `YYYY-MM: 說明` 格式，每行一筆，方便閱讀
